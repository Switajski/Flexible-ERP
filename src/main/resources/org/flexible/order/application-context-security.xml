<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:oauth="http://www.springframework.org/schema/security/oauth"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
                                http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                                http://www.springframework.org/schema/security 
                                http://www.springframework.org/schema/security/spring-security-3.1.xsd
                                http://www.springframework.org/schema/security/oauth 
                           		http://www.springframework.org/schema/security/spring-security-oauth-1.0.xsd">

	<http auto-config="true" use-expressions="true">
		<form-login login-processing-url="/resources/j_spring_security_check"
			login-page="/login" authentication-failure-url="/login?login_error=t" />
		<logout logout-url="/resources/j_spring_security_logout" />
		<intercept-url pattern="/choices/**" access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/member/**" access="isAuthenticated()" />
		<intercept-url pattern="/resources/**" access="permitAll" />
		<intercept-url pattern="/login/**" access="permitAll" />
		<intercept-url pattern="/**" access="permitAll" />
	</http>

	<authentication-manager alias="authenticationManager">
		<!-- SHA-256 values can be produced using 'echo -n your_desired_password 
			| sha256sum' (using normal *nix environments) -->
		<authentication-provider>
			<password-encoder hash="sha-256" />
			<user-service>
				<user name="admin"
					password="8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918"
					authorities="ROLE_ADMIN" />
				<user name="user"
					password="04f8996da763b7a969b1028ee3007569eaf3a635486ddab211d512c85b9df8fb"
					authorities="ROLE_USER" />
			</user-service>
		</authentication-provider>
	</authentication-manager>

	<oauth:consumer resource-details-service-ref="resourceDetails"
		oauth-failure-page="/oauthFailure">
		<oauth:url pattern="/magentoProducts/**" resources="magentoProducts" />
		<oauth:url pattern="/login/**" resources="none" />
	</oauth:consumer>

	<oauth:resource-details-service id="resourceDetails">
		<oauth:resource id="magentoProducts" key="f8922813b7f72e4c5aa274265c354d6"
			secret="6d8d815edb711186e68a48ee1ddb8cb4" request-token-url="http://www.switajski.de/initiate"
			user-authorization-url="http://www.switajski.de/admin/oauth_authorize"
			access-token-url="http://www.switajski.de/oauth/token" />
	</oauth:resource-details-service>
	
</beans:beans>